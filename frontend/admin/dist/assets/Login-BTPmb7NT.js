import{y as S,r as _,l as I,h as B,aB as F,z as L,B as o,R as s,J as l,al as d,a4 as R,O as v,A as U,u as h,P as A}from"./vendor-Dt6xM8n7.js";import{m as C,a as z,b}from"./elementPlus-DUIuSOAC.js";import{u as E}from"./index-CSI0wDto.js";import{a as M}from"./index-BIipHNwb.js";import{_ as N}from"./_plugin-vue_export-helper-DlAUqK2U.js";const q={class:"login-container"},D={class:"login-wrapper"},K={class:"login-card"},O={class:"login-header"},J={class:"logo"},P={class:"login-footer"},T={class:"demo-info"},j=S({__name:"Login",setup(G){const w=F(),y=E(),g=_(),c=_(!1),p=_(!1),r=I({username:"",password:""}),x={username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:20,message:"用户名长度在 3 到 20 个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:20,message:"密码长度在 6 到 20 个字符",trigger:"blur"}]},V=async()=>{var t,e;if(g.value)try{if(!await g.value.validate())return;c.value=!0,console.log("开始登录:",r);const a=await M.login(r);if(console.log("登录响应:",a),a.code===200&&a.data){const{token:i,user_info:u}=a.data,f={id:u.id,username:u.username,role:u.role,created_at:new Date().toISOString()};y.login(i,f),p.value?localStorage.setItem("remember_username",r.username):localStorage.removeItem("remember_username"),b.success("登录成功"),await w.push("/dashboard"),console.log("跳转到仪表板完成")}else console.error("登录失败:",a),b.error(a.message||"登录失败")}catch(n){console.error("登录异常:",n),b.error(((e=(t=n.response)==null?void 0:t.data)==null?void 0:e.message)||"登录失败，请稍后重试")}finally{c.value=!1}};return B(()=>{if(y.isLoggedIn){w.push("/dashboard");return}const t=localStorage.getItem("remember_username");t&&(r.username=t,p.value=!0),r.username||(r.username="admin",r.password="123456")}),(t,e)=>{const n=d("el-icon"),a=d("el-input"),i=d("el-form-item"),u=d("el-checkbox"),f=d("el-button"),k=d("el-form");return U(),L("div",q,[o("div",D,[o("div",K,[o("div",O,[o("div",J,[s(n,{size:"48",color:"#409EFF"},{default:l(()=>[s(h(C))]),_:1})]),e[3]||(e[3]=o("h1",{class:"title"},"在线轮椅租赁系统",-1)),e[4]||(e[4]=o("p",{class:"subtitle"},"管理后台",-1))]),s(k,{ref_key:"loginFormRef",ref:g,model:r,rules:x,class:"login-form",size:"large",onKeyup:R(V,["enter"])},{default:l(()=>[s(i,{prop:"username"},{default:l(()=>[s(a,{modelValue:r.username,"onUpdate:modelValue":e[0]||(e[0]=m=>r.username=m),placeholder:"请输入用户名","prefix-icon":"User",clearable:""},null,8,["modelValue"])]),_:1}),s(i,{prop:"password"},{default:l(()=>[s(a,{modelValue:r.password,"onUpdate:modelValue":e[1]||(e[1]=m=>r.password=m),type:"password",placeholder:"请输入密码","prefix-icon":"Lock","show-password":"",clearable:""},null,8,["modelValue"])]),_:1}),s(i,null,{default:l(()=>[s(u,{modelValue:p.value,"onUpdate:modelValue":e[2]||(e[2]=m=>p.value=m)},{default:l(()=>[...e[5]||(e[5]=[v(" 记住我 ",-1)])]),_:1},8,["modelValue"])]),_:1}),s(i,null,{default:l(()=>[s(f,{type:"primary",class:"login-button",loading:c.value,onClick:V},{default:l(()=>[v(A(c.value?"登录中...":"登录"),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"]),o("div",P,[o("p",T,[s(n,null,{default:l(()=>[s(h(z))]),_:1}),e[6]||(e[6]=v(" 演示账号：admin / 123456 ",-1))]),e[7]||(e[7]=o("p",{class:"copyright"}," © 2024 在线轮椅租赁系统. All rights reserved. ",-1))])])]),e[8]||(e[8]=o("div",{class:"background-decoration"},[o("div",{class:"decoration-circle circle-1"}),o("div",{class:"decoration-circle circle-2"}),o("div",{class:"decoration-circle circle-3"})],-1))])}}}),Z=N(j,[["__scopeId","data-v-99f2ad88"]]);export{Z as default};
