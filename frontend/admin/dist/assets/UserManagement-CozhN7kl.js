import{y as ne,r as m,l as R,h as de,z as W,R as e,J as t,al as d,B as i,K as E,a4 as ie,u as f,O as r,ar as ue,I as K,P as n,L as _e,A as C}from"./vendor-Dt6xM8n7.js";import{b as z,q as j,r as pe,u as ce,v as q,d as me}from"./elementPlus-DUIuSOAC.js";import{_ as ve}from"./_plugin-vue_export-helper-DlAUqK2U.js";const fe={class:"user-management"},ge={class:"table-toolbar"},he={class:"search-form"},be={class:"user-info"},ye={class:"user-avatar"},we={class:"user-details"},Ce={class:"user-name"},ze={class:"user-phone"},Ve={class:"address-text"},ke={class:"pagination-container"},xe={key:0,class:"user-detail"},Te={class:"user-orders"},Ze={class:"orders-toolbar"},Ue={class:"price"},De={class:"pagination-container",style:{"margin-top":"16px"}},Se=ne({__name:"UserManagement",setup(Oe){const V=m(!1),k=m(!1),x=m(!1),T=m(!1),U=m([]),D=m([]),o=m(null),S=m(0),O=m(0),p=R({page:1,limit:20,keyword:""}),_=R({page:1,limit:10,status:""}),A=s=>({待配送:"warning",已配送:"primary",使用中:"success",已归还:"info",已取消:"danger"})[s]||"info",g=s=>new Date(s).toLocaleString("zh-CN"),h=async()=>{try{V.value=!0;const s={items:[{id:1,name:"张三",phone:"13800138001",address:"北京市朝阳区某某街道123号",total_orders:5,active_orders:1,created_at:"2024-01-01T10:00:00Z",last_order_time:"2024-01-15T10:30:00Z"},{id:2,name:"李四",phone:"13800138002",address:"上海市浦东新区某某路456号",total_orders:3,active_orders:0,created_at:"2024-01-02T10:00:00Z",last_order_time:"2024-01-10T15:20:00Z"},{id:3,name:"王五",phone:"13800138003",address:"广州市天河区某某大道789号",total_orders:8,active_orders:2,created_at:"2023-12-15T10:00:00Z",last_order_time:"2024-01-14T09:00:00Z"},{id:4,name:"赵六",phone:"13800138004",address:"深圳市南山区某某科技园101号",total_orders:1,active_orders:0,created_at:"2024-01-10T10:00:00Z",last_order_time:"2024-01-12T14:30:00Z"},{id:5,name:"钱七",phone:"13800138005",address:"杭州市西湖区某某路202号",total_orders:0,active_orders:0,created_at:"2024-01-14T10:00:00Z",last_order_time:null}],total:5,page:1,limit:20,totalPages:1};U.value=s.items,S.value=s.total}catch(s){console.error("获取用户列表失败:",s),z.error("获取数据失败，请稍后重试")}finally{V.value=!1}},w=async()=>{if(o.value)try{k.value=!0;const s=[{id:1,order_no:"WR20240115001",user_name:o.value.name,user_phone:o.value.phone,user_address:o.value.address,wheelchair_id:1,wheelchair_name:"标准轮椅 SW-001",deposit:50,status:"使用中",create_time:"2024-01-15T10:30:00Z",delivery_time:"2024-01-15T14:30:00Z",return_time:null,notes:"用户要求下午配送"},{id:2,order_no:"WR20240110002",user_name:o.value.name,user_phone:o.value.phone,user_address:o.value.address,wheelchair_id:2,wheelchair_name:"电动轮椅 EW-002",deposit:120,status:"已归还",create_time:"2024-01-10T11:00:00Z",delivery_time:"2024-01-10T15:00:00Z",return_time:"2024-01-12T10:00:00Z",notes:null}];let l=s;_.status&&(l=s.filter(c=>c.status===_.status)),D.value=l,O.value=l.length}catch(s){console.error("获取用户订单失败:",s),z.error("获取订单数据失败")}finally{k.value=!1}},M=()=>{p.page=1,h()},J=()=>{Object.assign(p,{page:1,limit:20,keyword:""}),h()},F=s=>{p.limit=s,p.page=1,h()},G=s=>{p.page=s,h()},H=s=>{_.limit=s,_.page=1,w()},Q=s=>{_.page=s,w()},X=async s=>{try{o.value=s,x.value=!0}catch(l){console.error("获取用户详情失败:",l),z.error("获取用户详情失败")}},Y=s=>{o.value=s,_.page=1,_.status="",T.value=!0,w()},ee=s=>{z.info(`查看订单详情：${s.order_no}`)};return de(()=>{h()}),(s,l)=>{var I;const c=d("el-icon"),te=d("el-input"),b=d("el-button"),u=d("el-table-column"),ae=d("el-avatar"),le=d("el-tooltip"),Z=d("el-tag"),P=d("el-table"),B=d("el-pagination"),se=d("el-card"),v=d("el-descriptions-item"),oe=d("el-descriptions"),N=d("el-dialog"),y=d("el-option"),re=d("el-select"),$=ue("loading");return C(),W("div",fe,[e(se,null,{header:t(()=>[...l[8]||(l[8]=[i("div",{class:"card-header"},[i("span",null,"用户管理")],-1)])]),default:t(()=>[i("div",ge,[i("div",he,[e(te,{modelValue:p.keyword,"onUpdate:modelValue":l[0]||(l[0]=a=>p.keyword=a),placeholder:"搜索用户姓名或手机号",style:{width:"240px"},clearable:"",onKeyup:ie(M,["enter"])},{prefix:t(()=>[e(c,null,{default:t(()=>[e(f(j))]),_:1})]),_:1},8,["modelValue"]),e(b,{type:"primary",onClick:M},{default:t(()=>[e(c,null,{default:t(()=>[e(f(j))]),_:1}),l[9]||(l[9]=r(" 搜索 ",-1))]),_:1}),e(b,{onClick:J},{default:t(()=>[e(c,null,{default:t(()=>[e(f(pe))]),_:1}),l[10]||(l[10]=r(" 重置 ",-1))]),_:1})])]),E((C(),K(P,{data:U.value,stripe:"",style:{width:"100%"}},{default:t(()=>[e(u,{prop:"id",label:"ID",width:"80"}),e(u,{label:"用户信息","min-width":"200"},{default:t(({row:a})=>[i("div",be,[i("div",ye,[e(ae,{size:40},{default:t(()=>[e(c,null,{default:t(()=>[e(f(ce))]),_:1})]),_:1})]),i("div",we,[i("div",Ce,n(a.name),1),i("div",ze,n(a.phone),1)])])]),_:1}),e(u,{prop:"address",label:"地址","min-width":"200"},{default:t(({row:a})=>[e(le,{content:a.address,placement:"top"},{default:t(()=>[i("div",Ve,n(a.address),1)]),_:2},1032,["content"])]),_:1}),e(u,{prop:"total_orders",label:"总订单数",width:"100",align:"center"},{default:t(({row:a})=>[e(Z,{type:"info",size:"small"},{default:t(()=>[r(n(a.total_orders),1)]),_:2},1024)]),_:1}),e(u,{prop:"active_orders",label:"进行中订单",width:"120",align:"center"},{default:t(({row:a})=>[e(Z,{type:a.active_orders>0?"warning":"success",size:"small"},{default:t(()=>[r(n(a.active_orders),1)]),_:2},1032,["type"])]),_:1}),e(u,{prop:"created_at",label:"注册时间",width:"180"},{default:t(({row:a})=>[r(n(g(a.created_at)),1)]),_:1}),e(u,{prop:"last_order_time",label:"最后下单",width:"180"},{default:t(({row:a})=>[r(n(a.last_order_time?g(a.last_order_time):"无"),1)]),_:1}),e(u,{label:"操作",width:"150",fixed:"right"},{default:t(({row:a})=>[e(b,{type:"text",size:"small",onClick:L=>X(a)},{default:t(()=>[e(c,null,{default:t(()=>[e(f(q))]),_:1}),l[11]||(l[11]=r(" 详情 ",-1))]),_:1},8,["onClick"]),e(b,{type:"text",size:"small",onClick:L=>Y(a)},{default:t(()=>[e(c,null,{default:t(()=>[e(f(me))]),_:1}),l[12]||(l[12]=r(" 订单 ",-1))]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[$,V.value]]),i("div",ke,[e(B,{"current-page":p.page,"onUpdate:currentPage":l[1]||(l[1]=a=>p.page=a),"page-size":p.limit,"onUpdate:pageSize":l[2]||(l[2]=a=>p.limit=a),total:S.value,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:F,onCurrentChange:G},null,8,["current-page","page-size","total"])])]),_:1}),e(N,{modelValue:x.value,"onUpdate:modelValue":l[3]||(l[3]=a=>x.value=a),title:"用户详情",width:"600px"},{default:t(()=>[o.value?(C(),W("div",xe,[e(oe,{column:2,border:""},{default:t(()=>[e(v,{label:"用户ID"},{default:t(()=>[r(n(o.value.id),1)]),_:1}),e(v,{label:"姓名"},{default:t(()=>[r(n(o.value.name),1)]),_:1}),e(v,{label:"手机号"},{default:t(()=>[r(n(o.value.phone),1)]),_:1}),e(v,{label:"注册时间"},{default:t(()=>[r(n(g(o.value.created_at)),1)]),_:1}),e(v,{label:"地址",span:2},{default:t(()=>[r(n(o.value.address),1)]),_:1}),e(v,{label:"总订单数"},{default:t(()=>[r(n(o.value.total_orders),1)]),_:1}),e(v,{label:"进行中订单"},{default:t(()=>[r(n(o.value.active_orders),1)]),_:1}),e(v,{label:"最后下单时间",span:2},{default:t(()=>[r(n(o.value.last_order_time?g(o.value.last_order_time):"无"),1)]),_:1})]),_:1})])):_e("",!0)]),_:1},8,["modelValue"]),e(N,{modelValue:T.value,"onUpdate:modelValue":l[7]||(l[7]=a=>T.value=a),title:`${(I=o.value)==null?void 0:I.name} 的订单记录`,width:"1000px"},{default:t(()=>[i("div",Te,[i("div",Ze,[e(re,{modelValue:_.status,"onUpdate:modelValue":l[4]||(l[4]=a=>_.status=a),placeholder:"状态筛选",style:{width:"120px"},clearable:"",onChange:w},{default:t(()=>[e(y,{label:"待配送",value:"待配送"}),e(y,{label:"已配送",value:"已配送"}),e(y,{label:"使用中",value:"使用中"}),e(y,{label:"已归还",value:"已归还"}),e(y,{label:"已取消",value:"已取消"})]),_:1},8,["modelValue"])]),E((C(),K(P,{data:D.value,stripe:"",style:{width:"100%"}},{default:t(()=>[e(u,{prop:"order_no",label:"订单号",width:"180"}),e(u,{prop:"wheelchair_name",label:"轮椅","min-width":"150"}),e(u,{prop:"deposit",label:"定金",width:"100"},{default:t(({row:a})=>[i("span",Ue,"¥"+n(a.deposit),1)]),_:1}),e(u,{prop:"status",label:"状态",width:"100"},{default:t(({row:a})=>[e(Z,{type:A(a.status),size:"small"},{default:t(()=>[r(n(a.status),1)]),_:2},1032,["type"])]),_:1}),e(u,{prop:"create_time",label:"下单时间",width:"180"},{default:t(({row:a})=>[r(n(g(a.create_time)),1)]),_:1}),e(u,{label:"操作",width:"100"},{default:t(({row:a})=>[e(b,{type:"text",size:"small",onClick:L=>ee(a)},{default:t(()=>[e(c,null,{default:t(()=>[e(f(q))]),_:1}),l[13]||(l[13]=r(" 详情 ",-1))]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[$,k.value]]),i("div",De,[e(B,{"current-page":_.page,"onUpdate:currentPage":l[5]||(l[5]=a=>_.page=a),"page-size":_.limit,"onUpdate:pageSize":l[6]||(l[6]=a=>_.limit=a),total:O.value,"page-sizes":[5,10,20],layout:"total, sizes, prev, pager, next",onSizeChange:H,onCurrentChange:Q},null,8,["current-page","page-size","total"])])])]),_:1},8,["modelValue","title"])])}}}),Ne=ve(Se,[["__scopeId","data-v-eb51a036"]]);export{Ne as default};
