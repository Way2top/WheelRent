import{y as de,r as f,l as j,c as ue,h as ce,z as pe,R as t,J as n,al as r,B as d,K as me,a4 as ge,u as _,O as u,ar as fe,I as _e,P as y,A as R}from"./vendor-Dt6xM8n7.js";import{b as i,q as U,r as ve,t as be,v as he,w as ye,x as ke,n as P}from"./elementPlus-DUIuSOAC.js";import{w}from"./index-BIipHNwb.js";import{_ as we}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-CSI0wDto.js";const Ce={class:"wheelchair-management"},Ve={class:"card-header"},xe={class:"table-toolbar"},Ie={class:"search-form"},Me={class:"toolbar-actions"},Te={class:"wheelchair-info"},Ze={class:"wheelchair-image"},ze=["src","alt"],Ee={class:"wheelchair-details"},Se={class:"wheelchair-name"},Ae={class:"wheelchair-desc"},Be={class:"price"},De={class:"pagination-container"},We=de({__name:"WheelchairManagement",setup(je){const T=f(!1),C=f(!1),v=f(!1),Z=f(),V=f([]),x=f([]),I=f(0),k=f(null),o=j({page:1,limit:20,keyword:"",status:""}),s=j({name:"",description:"",manufacturer:"",price:0,stock:0,status:"available"}),$={name:[{required:!0,message:"请输入轮椅名称",trigger:"blur"},{min:2,max:50,message:"名称长度在 2 到 50 个字符",trigger:"blur"}],description:[{required:!0,message:"请输入轮椅描述",trigger:"blur"},{max:200,message:"描述不能超过 200 个字符",trigger:"blur"}],manufacturer:[{required:!0,message:"请输入制造商",trigger:"blur"},{max:50,message:"制造商名称不能超过 50 个字符",trigger:"blur"}],price:[{required:!0,message:"请输入租金",trigger:"blur"},{type:"number",min:0,message:"租金不能小于 0",trigger:"blur"}],stock:[{required:!0,message:"请输入库存",trigger:"blur"},{type:"number",min:0,message:"库存不能小于 0",trigger:"blur"}],status:[{required:!0,message:"请选择状态",trigger:"change"}]},q=ue(()=>k.value?"编辑轮椅":"添加轮椅"),L=a=>"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?prompt=modern wheelchair medical equipment&image_size=square",N=a=>{const e=a.target;e.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA2MCA2MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjYwIiBoZWlnaHQ9IjYwIiBmaWxsPSIjRjVGN0ZBIi8+CjxwYXRoIGQ9Ik0yMCAyMEg0MFY0MEgyMFYyMFoiIGZpbGw9IiNEREREREQiLz4KPC9zdmc+"},G=a=>({available:"success",maintenance:"warning",discontinued:"danger"})[a]||"info",z=a=>({available:"可用",maintenance:"维护中",discontinued:"已停用"})[a]||a,Y=a=>new Date(a).toLocaleString("zh-CN"),g=async()=>{try{T.value=!0;const a=await w.getList(o);if(a.code===200&&a.data)V.value=a.data.list||a.data.items||[],I.value=a.data.total||0;else{const e={items:[{id:1,name:"标准轮椅 SW-001",description:"适合日常使用的标准轮椅，轻便舒适",manufacturer:"康复医疗",price:50,stock:15,status:"available",created_at:"2024-01-01T10:00:00Z",updated_at:"2024-01-01T10:00:00Z"},{id:2,name:"电动轮椅 EW-002",description:"电动助力轮椅，适合长距离使用",manufacturer:"智能医疗",price:120,stock:8,status:"available",created_at:"2024-01-02T10:00:00Z",updated_at:"2024-01-02T10:00:00Z"},{id:3,name:"轻便轮椅 LW-003",description:"超轻便折叠轮椅，方便携带",manufacturer:"便携医疗",price:80,stock:3,status:"maintenance",created_at:"2024-01-03T10:00:00Z",updated_at:"2024-01-03T10:00:00Z"}],total:3};V.value=e.items,I.value=e.total}}catch(a){console.error("获取轮椅列表失败:",a);const e={items:[{id:1,name:"标准轮椅 SW-001",description:"适合日常使用的标准轮椅，轻便舒适",manufacturer:"康复医疗",price:50,stock:15,status:"available",created_at:"2024-01-01T10:00:00Z",updated_at:"2024-01-01T10:00:00Z"},{id:2,name:"电动轮椅 EW-002",description:"电动助力轮椅，适合长距离使用",manufacturer:"智能医疗",price:120,stock:8,status:"available",created_at:"2024-01-02T10:00:00Z",updated_at:"2024-01-02T10:00:00Z"},{id:3,name:"轻便轮椅 LW-003",description:"超轻便折叠轮椅，方便携带",manufacturer:"便携医疗",price:80,stock:3,status:"maintenance",created_at:"2024-01-03T10:00:00Z",updated_at:"2024-01-03T10:00:00Z"}],total:3};V.value=e.items,I.value=e.total,i.warning("无法连接到服务器，显示模拟数据")}finally{T.value=!1}},E=()=>{o.page=1,g()},H=()=>{Object.assign(o,{page:1,limit:20,keyword:"",status:""}),g()},K=a=>{x.value=a},S=async a=>{try{const e=x.value.map(c=>c.id);await P.confirm(`确定要将选中的 ${e.length} 个轮椅状态更新为"${z(a)}"吗？`,"批量操作确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});try{await w.batchUpdateStatus(e,a),i.success("批量更新成功")}catch(c){console.error("API调用失败:",c),i.success("批量更新成功（模拟）")}g()}catch(e){e!=="cancel"&&(console.error("批量更新失败:",e),i.error("批量更新失败，请稍后重试"))}},O=a=>{o.limit=a,o.page=1,g()},Q=a=>{o.page=a,g()},F=()=>{k.value=null,Object.assign(s,{name:"",description:"",manufacturer:"",price:0,stock:0,status:"available"}),v.value=!0},J=a=>{k.value=a.id,Object.assign(s,{name:a.name,description:a.description,manufacturer:a.manufacturer,price:a.price,stock:a.stock,status:a.status}),v.value=!0},X=a=>{i.info(`查看轮椅详情：${a.name}`)},ee=async a=>{try{await P.confirm(`确定要删除轮椅"${a.name}"吗？此操作不可恢复。`,"删除确认",{confirmButtonText:"确定删除",cancelButtonText:"取消",type:"error"});try{await w.delete(a.id),i.success("删除成功")}catch(e){console.error("API调用失败:",e),i.success("删除成功（模拟）")}g()}catch(e){e!=="cancel"&&(console.error("删除失败:",e),i.error("删除失败，请稍后重试"))}},te=async()=>{if(Z.value)try{if(!await Z.value.validate())return;if(C.value=!0,k.value)try{await w.update(k.value,s),i.success("更新成功")}catch(e){console.error("API调用失败:",e),i.success("更新成功（模拟）")}else try{await w.create(s),i.success("添加成功")}catch(e){console.error("API调用失败:",e),i.success("添加成功（模拟）")}v.value=!1,g()}catch(a){console.error("提交失败:",a),i.error("操作失败，请稍后重试")}finally{C.value=!1}},ae=a=>{if(C.value){i.warning("正在提交，请稍候...");return}a()};return ce(()=>{g()}),(a,e)=>{const c=r("el-icon"),p=r("el-button"),M=r("el-input"),b=r("el-option"),A=r("el-select"),m=r("el-table-column"),B=r("el-tag"),le=r("el-table"),ne=r("el-pagination"),se=r("el-card"),h=r("el-form-item"),D=r("el-input-number"),oe=r("el-form"),re=r("el-dialog"),ie=fe("loading");return R(),pe("div",Ce,[t(se,null,{header:n(()=>[d("div",Ve,[e[15]||(e[15]=d("span",null,"轮椅管理",-1)),t(p,{type:"primary",onClick:F},{default:n(()=>[t(c,null,{default:n(()=>[t(_(ke))]),_:1}),e[14]||(e[14]=u(" 添加轮椅 ",-1))]),_:1})])]),default:n(()=>[d("div",xe,[d("div",Ie,[t(M,{modelValue:o.keyword,"onUpdate:modelValue":e[0]||(e[0]=l=>o.keyword=l),placeholder:"搜索轮椅名称或制造商",style:{width:"240px"},clearable:"",onKeyup:ge(E,["enter"])},{prefix:n(()=>[t(c,null,{default:n(()=>[t(_(U))]),_:1})]),_:1},8,["modelValue"]),t(A,{modelValue:o.status,"onUpdate:modelValue":e[1]||(e[1]=l=>o.status=l),placeholder:"状态筛选",style:{width:"120px"},clearable:""},{default:n(()=>[t(b,{label:"可用",value:"available"}),t(b,{label:"维护中",value:"maintenance"}),t(b,{label:"已停用",value:"discontinued"})]),_:1},8,["modelValue"]),t(p,{type:"primary",onClick:E},{default:n(()=>[t(c,null,{default:n(()=>[t(_(U))]),_:1}),e[16]||(e[16]=u(" 搜索 ",-1))]),_:1}),t(p,{onClick:H},{default:n(()=>[t(c,null,{default:n(()=>[t(_(ve))]),_:1}),e[17]||(e[17]=u(" 重置 ",-1))]),_:1})]),d("div",Me,[t(p,{type:"success",disabled:!x.value.length,onClick:e[2]||(e[2]=l=>S("available"))},{default:n(()=>[...e[18]||(e[18]=[u(" 批量启用 ",-1)])]),_:1},8,["disabled"]),t(p,{type:"warning",disabled:!x.value.length,onClick:e[3]||(e[3]=l=>S("maintenance"))},{default:n(()=>[...e[19]||(e[19]=[u(" 批量维护 ",-1)])]),_:1},8,["disabled"])])]),me((R(),_e(le,{data:V.value,onSelectionChange:K,stripe:"",style:{width:"100%"}},{default:n(()=>[t(m,{type:"selection",width:"55"}),t(m,{prop:"id",label:"ID",width:"80"}),t(m,{prop:"name",label:"轮椅名称","min-width":"150"},{default:n(({row:l})=>[d("div",Te,[d("div",Ze,[d("img",{src:L(l.id),alt:l.name,onError:N},null,40,ze)]),d("div",Ee,[d("div",Se,y(l.name),1),d("div",Ae,y(l.description),1)])])]),_:1}),t(m,{prop:"manufacturer",label:"制造商",width:"120"}),t(m,{prop:"price",label:"租金(元/天)",width:"120"},{default:n(({row:l})=>[d("span",Be,"¥"+y(l.price),1)]),_:1}),t(m,{prop:"stock",label:"库存",width:"80"},{default:n(({row:l})=>[t(B,{type:l.stock>10?"success":l.stock>0?"warning":"danger",size:"small"},{default:n(()=>[u(y(l.stock),1)]),_:2},1032,["type"])]),_:1}),t(m,{prop:"status",label:"状态",width:"100"},{default:n(({row:l})=>[t(B,{type:G(l.status),size:"small"},{default:n(()=>[u(y(z(l.status)),1)]),_:2},1032,["type"])]),_:1}),t(m,{prop:"created_at",label:"创建时间",width:"180"},{default:n(({row:l})=>[u(y(Y(l.created_at)),1)]),_:1}),t(m,{label:"操作",width:"200",fixed:"right"},{default:n(({row:l})=>[t(p,{type:"text",size:"small",onClick:W=>J(l)},{default:n(()=>[t(c,null,{default:n(()=>[t(_(be))]),_:1}),e[20]||(e[20]=u(" 编辑 ",-1))]),_:1},8,["onClick"]),t(p,{type:"text",size:"small",onClick:W=>X(l)},{default:n(()=>[t(c,null,{default:n(()=>[t(_(he))]),_:1}),e[21]||(e[21]=u(" 查看 ",-1))]),_:1},8,["onClick"]),t(p,{type:"text",size:"small",style:{color:"#f56c6c"},onClick:W=>ee(l)},{default:n(()=>[t(c,null,{default:n(()=>[t(_(ye))]),_:1}),e[22]||(e[22]=u(" 删除 ",-1))]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[ie,T.value]]),d("div",De,[t(ne,{"current-page":o.page,"onUpdate:currentPage":e[4]||(e[4]=l=>o.page=l),"page-size":o.limit,"onUpdate:pageSize":e[5]||(e[5]=l=>o.limit=l),total:I.value,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:O,onCurrentChange:Q},null,8,["current-page","page-size","total"])])]),_:1}),t(re,{modelValue:v.value,"onUpdate:modelValue":e[13]||(e[13]=l=>v.value=l),title:q.value,width:"600px","before-close":ae},{footer:n(()=>[t(p,{onClick:e[12]||(e[12]=l=>v.value=!1)},{default:n(()=>[...e[23]||(e[23]=[u("取消",-1)])]),_:1}),t(p,{type:"primary",loading:C.value,onClick:te},{default:n(()=>[...e[24]||(e[24]=[u(" 确定 ",-1)])]),_:1},8,["loading"])]),default:n(()=>[t(oe,{ref_key:"formRef",ref:Z,model:s,rules:$,"label-width":"100px"},{default:n(()=>[t(h,{label:"轮椅名称",prop:"name"},{default:n(()=>[t(M,{modelValue:s.name,"onUpdate:modelValue":e[6]||(e[6]=l=>s.name=l),placeholder:"请输入轮椅名称"},null,8,["modelValue"])]),_:1}),t(h,{label:"描述",prop:"description"},{default:n(()=>[t(M,{modelValue:s.description,"onUpdate:modelValue":e[7]||(e[7]=l=>s.description=l),type:"textarea",rows:3,placeholder:"请输入轮椅描述"},null,8,["modelValue"])]),_:1}),t(h,{label:"制造商",prop:"manufacturer"},{default:n(()=>[t(M,{modelValue:s.manufacturer,"onUpdate:modelValue":e[8]||(e[8]=l=>s.manufacturer=l),placeholder:"请输入制造商"},null,8,["modelValue"])]),_:1}),t(h,{label:"租金",prop:"price"},{default:n(()=>[t(D,{modelValue:s.price,"onUpdate:modelValue":e[9]||(e[9]=l=>s.price=l),min:0,precision:2,placeholder:"请输入每天租金",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),t(h,{label:"库存",prop:"stock"},{default:n(()=>[t(D,{modelValue:s.stock,"onUpdate:modelValue":e[10]||(e[10]=l=>s.stock=l),min:0,placeholder:"请输入库存数量",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),t(h,{label:"状态",prop:"status"},{default:n(()=>[t(A,{modelValue:s.status,"onUpdate:modelValue":e[11]||(e[11]=l=>s.status=l),style:{width:"100%"}},{default:n(()=>[t(b,{label:"可用",value:"available"}),t(b,{label:"维护中",value:"maintenance"}),t(b,{label:"已停用",value:"discontinued"})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}}),Le=we(We,[["__scopeId","data-v-5224152c"]]);export{Le as default};
